<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cute Productivity Hub 🌸</title>
    <style>
        /* Global Styles (unchanged) */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(to bottom, #ffeef8, #e8f4f8);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            transition: background 0.3s ease, color 0.3s ease;
        }
        .dark-mode {
            background: linear-gradient(to bottom, #2c3e50, #34495e);
            color: #ecf0f1;
        }
        .dark-mode .card, .dark-mode .character, .dark-mode .character-label, .dark-mode .game-canvas {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }
        h1, h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #ff69b4;
        }
        .dark-mode h1, .dark-mode h2 {
            color: #ff9ff3;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .section {
            margin-bottom: 40px;
            padding: 20px;
            background: rgba(255,255,255,0.8);
            border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        .dark-mode .section {
            background: rgba(0,0,0,0.3);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        button {
            background: #ff69b4;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-family: inherit;
            transition: background 0.3s ease;
        }
        button:hover {
            background: #ff1493;
        }
        input, textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #ff69b4;
            border-radius: 10px;
            margin-bottom: 10px;
            font-family: inherit;
        }
        .card {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.2s ease;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .checkbox {
            transform: scale(1.5);
            margin-right: 10px;
        }
        
        /* Updated Character Styles */
        .characters {
            position: relative;
            height: 200px;
            border: 2px dashed #ff69b4;
            border-radius: 20px;
            margin: 20px 0;
            background: rgba(255,255,255,0.5);
            overflow: hidden;
        }
        .character-container {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            user-select: none;
            z-index: 10;
        }
        .character {
            font-size: 50px;
            cursor: grab;
            transition: transform 0.2s ease;
            border-radius: 50%;
            padding: 10px;
            background: rgba(255,255,255,0.8);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .character:active {
            cursor: grabbing;
        }
        .character:hover {
            transform: scale(1.1);
        }
        .character-label {
            margin-top: 5px;
            padding: 3px 8px;
            border-radius: 15px;
            background: rgba(255,255,255,0.9);
            font-size: 12px;
            color: #ff69b4;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .speech-bubble {
            position: absolute;
            background: #fff;
            border: 2px solid #ff69b4;
            border-radius: 20px;
            padding: 10px;
            max-width: 200px;
            font-size: 14px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
            z-index: 20;
            animation: bounce 0.5s ease;
        }
        .speech-bubble::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 20px;
            border: 10px solid transparent;
            border-top-color: #ff69b4;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        /* Assignments */
        #assignments-list {
            max-height: 400px;
            overflow-y: auto;
        }
        .deadline {
            color: #ff69b4;
            font-weight: bold;
        }
        
        /* Messaging */
        #message-form {
            display: none;
        }
        
        /* Photo */
        #photo-preview {
            display: none;
            text-align: center;
            margin-top: 10px;
        }
        #photo-preview img {
            max-width: 100%;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        /* Game */
        .game-container {
            text-align: center;
        }
        .game-canvas {
            border: 2px solid #ff69b4;
            border-radius: 15px;
            background: #fff;
            touch-action: none;
        }
        
        /* Footer */
        .footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        .clock {
            font-size: 18px;
            color: #ff69b4;
        }
        .quote {
            text-align: center;
            font-style: italic;
            margin: 10px 0;
        }
        .toggle {
            background: #4ecdc4;
        }
        .toggle:hover {
            background: #45b7aa;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .section {
                padding: 15px;
            }
            .character {
                font-size: 40px;
            }
            .footer {
                flex-direction: column;
                gap: 10px;
            }
        }
        
        /* Draggable Touch Support */
        @media (hover: none) {
            .character {
                touch-action: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Cute Productivity Hub 🌸</h1>
        
        <div class="section">
            <h2>Meet Alex & Shab</h2>
            <div class="characters" id="characters-area">
                <div class="character-container" id="alex-container">
                    <div class="character" id="alex" draggable="true">👧</div>
                    <div class="character-label">Alex</div>
                </div>
                <div class="character-container" id="shab-container" style="left: 50px; top: 50px;">
                    <div class="character" id="shab" draggable="true">👦</div>
                    <div class="character-label">Shab</div>
                </div>
                
            </div>
            <div id="speech-bubble" class="speech-bubble"></div>
        </div>

        <div class="section">
            <h2>📚 My Assignments</h2>
            <form id="add-assignment">
                <input type="text" id="subject" placeholder="Subject" required>
                <input type="datetime-local" id="deadline" required>
                <textarea id="context" placeholder="Short description" required></textarea>
                <button type="submit">Add Assignment</button>
            </form>
            <div id="assignments-list"></div>
        </div>

        <div class="section">
            <h2>💬 Send Me a Message</h2>
            <button id="open-message">Send Me a Message</button>
            <form id="message-form" action="https://formspree.io/f/YOUR_FORMSPREE_ID" method="POST">
                <input type="email" name="email" placeholder="Your email" required>
                <textarea name="message" placeholder="Your message" required></textarea>
                <button type="submit">Send</button>
            </form>
        </div>

        <div class="section">
            <h2>📸 My Photo Moment</h2>
            <input type="file" id="photo-upload" accept="image/*">
            <input type="url" id="photo-url" placeholder="Or enter image URL">
            <button onclick="loadPhoto()">Preview Photo</button>
            <div id="photo-preview" class="card">
                <img id="preview-img" src="" alt="Preview">
                <p id="photo-text">A cute moment captured! 🌟</p>
            </div>
        </div>

        <div class="section">
            <h2>🎮 Feed the Bunny Game</h2>
            <div class="game-container">
                <canvas id="game-canvas" class="game-canvas" width="300" height="200"></canvas>
                <p>Tap/Click to feed the bunny carrots! 🥕</p>
                <p>Score: <span id="score">0</span></p>
            </div>
        </div>

        <div class="footer">
            <div class="clock" id="clock"></div>
            <div class="quote" id="quote"></div>
            <button class="toggle" onclick="toggleDarkMode()">🌙 Toggle Dark Mode</button>
        </div>
    </div>

    <script>
        // Global Variables
        let assignments = JSON.parse(localStorage.getItem('assignments')) || [];
        let score = 0;
        let gameBunny = { x: 150, y: 100, vx: 1, vy: 1 };
        let gameCarrots = [];
        const quotes = [
            "You got this! 💪 - Alex",
            "Keep shining bright! ✨ - Shab",
            "One step at a time! 🐢 - Alex",
            "Dream big, work hard! 🌟 - Shab"
        ];
        let currentQuote = 0;

        // Web Speech API
        function speak(text, character = 'Alex') {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.8;
                utterance.pitch = character === 'Alex' ? 1.5 : 1.0;
                speechSynthesis.speak(utterance);
            }
            showBubble(text, character);
        }

        function showBubble(text, character) {
            const bubble = document.getElementById('speech-bubble');
            bubble.textContent = `${character}: ${text}`;
            bubble.style.display = 'block';
            const charEl = document.getElementById(character.toLowerCase());
            const containerEl = charEl.parentElement;
            bubble.style.left = (containerEl.offsetLeft + 20) + 'px';
            bubble.style.top = (containerEl.offsetTop - 50) + 'px';
            setTimeout(() => { bubble.style.display = 'none'; }, 3000);
        }

        // Greetings on Load
        window.onload = function() {
            speak('Hi! I\'m Alex, ready to help you stay productive! 🌸', 'Alex');
            setTimeout(() => speak('Hey! Shab here, let\'s crush those goals! 🚀', 'Shab'), 2000);
            loadAssignments();
            updateClock();
            setInterval(updateClock, 1000);
            setInterval(checkReminders, 60000); // Check every minute
            changeQuote();
            setInterval(changeQuote, 30000); // Change quote every 30s
            initGame();
            initDraggable();
        };

        // Draggable Characters (Mouse + Touch) - Updated for containers
        function initDraggable() {
            const charactersArea = document.getElementById('characters-area');
            const containers = document.querySelectorAll('.character-container');
            let draggedElement = null;
            let offset = { x: 0, y: 0 };

            function handleStart(e, el) {
                draggedElement = el;
                const rect = el.getBoundingClientRect();
                if (e.type === 'touchstart') {
                    offset.x = e.touches[0].clientX - rect.left;
                    offset.y = e.touches[0].clientY - rect.top;
                } else {
                    offset.x = e.clientX - rect.left;
                    offset.y = e.clientY - rect.top;
                    e.preventDefault();
                }
                el.style.zIndex = '100';
            }

            function handleMove(e) {
                if (!draggedElement) return;
                let clientX, clientY;
                if (e.type === 'touchmove') {
                    clientX = e.touches[0].clientX;
                    clientY = e.touches[0].clientY;
                } else {
                    clientX = e.clientX;
                    clientY = e.clientY;
                }
                const areaRect = charactersArea.getBoundingClientRect();
                draggedElement.style.left = (clientX - areaRect.left - offset.x) + 'px';
                draggedElement.style.top = (clientY - areaRect.top - offset.y) + 'px';
                e.preventDefault();
            }

            function handleEnd() {
                if (draggedElement) {
                    draggedElement.style.zIndex = '10';
                    draggedElement = null;
                }
            }

            containers.forEach(el => {
                el.addEventListener('mousedown', (e) => handleStart(e, el));
                el.addEventListener('touchstart', (e) => handleStart(e, el), { passive: false });

                // Also allow dragging via the character emoji itself
                const characterEl = el.querySelector('.character');
                characterEl.addEventListener('mousedown', (e) => handleStart(e, el));
                characterEl.addEventListener('touchstart', (e) => handleStart(e, el), { passive: false });
            });

            charactersArea.addEventListener('mousemove', handleMove);
            charactersArea.addEventListener('touchmove', handleMove, { passive: false });

            document.addEventListener('mouseup', handleEnd);
            document.addEventListener('touchend', handleEnd);
        }

        // Assignments
        document.getElementById('add-assignment').addEventListener('submit', function(e) {
            e.preventDefault();
            const subject = document.getElementById('subject').value;
            const deadline = new Date(document.getElementById('deadline').value);
            const context = document.getElementById('context').value;
            const isoDeadline = deadline.toISOString();
            const assignment = { subject, deadline: isoDeadline, context, done: false };
            assignments.push(assignment);
            localStorage.setItem('assignments', JSON.stringify(assignments));
            loadAssignments();
            this.reset();
            speak('Assignment added! Let\'s get it done! 📝', 'Alex');
        });

        function loadAssignments() {
            const list = document.getElementById('assignments-list');
            list.innerHTML = '';
            assignments.forEach((assign, index) => {
                const card = document.createElement('div');
                card.className = 'card';
                const now = new Date();
                const deadline = new Date(assign.deadline);
                const timeLeft = deadline - now;
                let status = '';
                if (assign.done) {
                    status = '✅ Done!';
                } else if (timeLeft < 0) {
                    status = '⏰ Overdue!';
                } else if (timeLeft < 3600000) { // 1 hour
                    status = '🚨 Soon!';
                } else {
                    status = '⏳ In progress';
                }
                const formattedDeadline = new Intl.DateTimeFormat('default', {
                    dateStyle: 'medium',
                    timeStyle: 'short'
                }).format(deadline);
                card.innerHTML = `
                    <h3>${assign.subject}</h3>
                    <p class="deadline">Deadline: ${formattedDeadline}</p>
                    <p>${assign.context}</p>
                    <p>${status}</p>
                    <label><input type="checkbox" class="checkbox" ${assign.done ? 'checked' : ''} onchange="toggleDone(${index})"> Mark as Done</label>
                `;
                list.appendChild(card);
            });
        }

        function toggleDone(index) {
            assignments[index].done = !assignments[index].done;
            localStorage.setItem('assignments', JSON.stringify(assignments));
            loadAssignments();
            if (assignments[index].done) {
                speak('Yay! Great job completing that! 🎉', 'Shab');
            }
        }

        function checkReminders() {
            const now = new Date();
            assignments.forEach(assign => {
                if (!assign.done) {
                    const deadline = new Date(assign.deadline);
                    const timeLeft = deadline - now;
                    if (timeLeft > 0 && timeLeft < 3600000) { // 1 hour
                        speak(`Reminder: ${assign.subject} is due soon! ⏰`, 'Alex');
                    }
                }
            });
        }

        // Messaging
        document.getElementById('open-message').addEventListener('click', function() {
            document.getElementById('message-form').style.display = 'block';
            this.style.display = 'none';
        });

        document.getElementById('message-form').addEventListener('submit', function() {
            speak('Thanks for your message! I\'ll get back to you soon! 💌', 'Alex');
            setTimeout(() => { this.style.display = 'none'; document.getElementById('open-message').style.display = 'block'; }, 2000);
        });

        // Photo
        function loadPhoto() {
            const fileInput = document.getElementById('photo-upload');
            const urlInput = document.getElementById('photo-url');
            const preview = document.getElementById('photo-preview');
            const img = document.getElementById('preview-img');

            if (fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    img.src = e.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(fileInput.files[0]);
            } else if (urlInput.value) {
                img.src = urlInput.value;
                preview.style.display = 'block';
            }
        }

        // Game
        function initGame() {
            const canvas = document.getElementById('game-canvas');
            const ctx = canvas.getContext('2d');
            let animationId;

            function draw() {
                // Clear
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Bunny
                ctx.fillStyle = '#ff69b4';
                ctx.beginPath();
                ctx.arc(gameBunny.x, gameBunny.y, 15, 0, Math.PI * 2);
                ctx.fill();
                
                // Bunny face details
                ctx.fillStyle = '#000';
                ctx.beginPath();
                ctx.arc(gameBunny.x - 5, gameBunny.y - 3, 3, 0, Math.PI * 2);
                ctx.arc(gameBunny.x + 5, gameBunny.y - 3, 3, 0, Math.PI * 2);
                ctx.fill();
                
                // Bunny mouth
                ctx.beginPath();
                ctx.arc(gameBunny.x, gameBunny.y + 3, 5, 0, Math.PI);
                ctx.stroke();

                // Carrots
                ctx.fillStyle = 'orange';
                gameCarrots.forEach(carrot => {
                    ctx.beginPath();
                    ctx.moveTo(carrot.x, carrot.y - 8);
                    ctx.lineTo(carrot.x - 5, carrot.y + 8);
                    ctx.lineTo(carrot.x + 5, carrot.y + 8);
                    ctx.closePath();
                    ctx.fill();
                    
                    // Carrot stem
                    ctx.fillStyle = 'green';
                    ctx.beginPath();
                    ctx.moveTo(carrot.x, carrot.y - 8);
                    ctx.lineTo(carrot.x - 3, carrot.y - 14);
                    ctx.lineTo(carrot.x + 3, carrot.y - 14);
                    ctx.closePath();
                    ctx.fill();
                    ctx.fillStyle = 'orange';
                });

                // Draw next frame
                animationId = requestAnimationFrame(draw);
            }

            function update() {
                // Move bunny
                gameBunny.x += gameBunny.vx;
                gameBunny.y += gameBunny.vy;
                
                // Bounce off walls
                if (gameBunny.x <= 15 || gameBunny.x >= canvas.width - 15) gameBunny.vx *= -1;
                if (gameBunny.y <= 15 || gameBunny.y >= canvas.height - 15) gameBunny.vy *= -1;
                
                // Move carrots randomly
                gameCarrots.forEach(carrot => {
                    carrot.x += carrot.vx;
                    carrot.y += carrot.vy;
                    
                    // Check if out of bounds
                    if (carrot.x < 0 || carrot.x > canvas.width || 
                        carrot.y < 0 || carrot.y > canvas.height) {
                        carrot.active = false;
                    }
                    
                    // Check collision with bunny
                    const dx = carrot.x - gameBunny.x;
                    const dy = carrot.y - gameBunny.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < 23 && carrot.active) {
                        carrot.active = false;
                        score++;
                        document.getElementById('score').textContent = score;
                        speak('Yum! Thanks for the carrot! 🥕', 'Alex');
                    }
                });
                
                // Remove inactive carrots
                gameCarrots = gameCarrots.filter(carrot => carrot.active);
                
                // Add new carrot occasionally
                if (Math.random() < 0.02) {
                    gameCarrots.push({
                        x: Math.random() * canvas.width,
                        y: 0,
                        vx: (Math.random() - 0.5) * 2,
                        vy: Math.random() * 2 + 1,
                        active: true
                    });
                }
            }

            function gameLoop() {
                update();
                draw();
            }

            // Start game loop
            draw();
            setInterval(update, 1000/60);

            // Handle clicks/taps
            canvas.addEventListener('click', function(e) {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                // Add a new carrot at click position
                gameCarrots.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 2,
                    vy: -2, // Move upward
                    active: true
                });
            });

            // Touch support for mobile
            canvas.addEventListener('touchstart', function(e) {
                e.preventDefault();
                const rect = canvas.getBoundingClientRect();
                const x = e.touches[0].clientX - rect.left;
                const y = e.touches[0].clientY - rect.top;
                
                // Add a new carrot at touch position
                gameCarrots.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 2,
                    vy: -2, // Move upward
                    active: true
                });
            }, { passive: false });
        }

        // Clock
        function updateClock() {
            const now = new Date();
            document.getElementById('clock').textContent = now.toLocaleTimeString();
        }

        // Quotes
        function changeQuote() {
            document.getElementById('quote').textContent = quotes[currentQuote];
            currentQuote = (currentQuote + 1) % quotes.length;
        }

        // Dark mode toggle
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
        }
    </script>
</body>
</html>
